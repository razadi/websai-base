import { Component, OnInit } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { SharedService } from '../../services/shared/shared.service';

@Component({
  selector: 'app-cuenta',
  templateUrl: './cuenta.component.html',
  styleUrls: ['./cuenta.component.css']
})
export class CuentaComponent implements OnInit {

  folio: number;
  serie: string;
  edo: string;
  estado: string;

  factura: any[] = [];
  facts: any[] = [];

  fact: any;

  constructor(
    private route: ActivatedRoute,
    private sharedServ: SharedService
  ) { 
    this.folio = this.route.snapshot.params['folio'];
    this.serie = 'A';

    this.facts = [
      {NUM_REFE: 'REF18000001', NUM_SERIE: 'A', FOL_FACT: 2399, FEC_FACT: '10/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000021', NUM_SERIE: 'A', FOL_FACT: 2400, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '6'},
      {NUM_REFE: 'REF18000002', NUM_SERIE: 'A', FOL_FACT: 2401, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000003', NUM_SERIE: 'A', FOL_FACT: 2402, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000004', NUM_SERIE: 'A', FOL_FACT: 2403, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000005', NUM_SERIE: 'A', FOL_FACT: 2404, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000006', NUM_SERIE: 'A', FOL_FACT: 2405, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000007', NUM_SERIE: 'A', FOL_FACT: 2406, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000008', NUM_SERIE: 'A', FOL_FACT: 2407, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '6'},
      {NUM_REFE: 'REF18000009', NUM_SERIE: 'A', FOL_FACT: 2408, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000010', NUM_SERIE: 'A', FOL_FACT: 2409, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '6'},
      {NUM_REFE: 'REF18000011', NUM_SERIE: 'A', FOL_FACT: 2410, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000012', NUM_SERIE: 'A', FOL_FACT: 2411, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '6'},
      {NUM_REFE: 'REF18000013', NUM_SERIE: 'A', FOL_FACT: 2412, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000014', NUM_SERIE: 'A', FOL_FACT: 2413, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '7'},
      {NUM_REFE: 'REF18000015', NUM_SERIE: 'A', FOL_FACT: 2414, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000016', NUM_SERIE: 'A', FOL_FACT: 2415, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000017', NUM_SERIE: 'A', FOL_FACT: 2416, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '7'},
      {NUM_REFE: 'REF18000018', NUM_SERIE: 'A', FOL_FACT: 2417, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000019', NUM_SERIE: 'A', FOL_FACT: 2418, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '4'},
      {NUM_REFE: 'REF18000020', NUM_SERIE: 'A', FOL_FACT: 2420, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '8'},
      {NUM_REFE: 'REF18000021', NUM_SERIE: 'A', FOL_FACT: 2421, FEC_FACT: '15/11/2018 11:40:44 a. m.', FACT_UUID: '12BA786C-376F-47B8-ADD3-88E8C8C043D0', FEC_TIMB: '15/11/2018 11:40:47 a. m.', RAZ_FACT: 'INTELIGENCIA SOLAR MEXICO SA  DE CV', RFC_FACT: 'ISM1010187F2', TOT_INGRS: 7432.65, EDO_CUEN: '8'}
    ];

    // buecar en el arreglo
    // let index = this.facts.findIndex(x => x.FOL_FACT === this.folio);
    // let array: any;
    // let index = this.facts.findIndex(array, {FOL_FACT: this.folio});
    // this.fact = this.facts.filter(data => data.FOL_FACT === this.folio);

    // console.log(this.folio, this.fact);
    let index = this.sharedServ.findIndexByKeyValueNum(this.facts, 'FOL_FACT', this.folio);
    this.fact = this.facts[index];
    // console.log(this.fact.EDO_CUEN);
    if (this.fact.EDO_CUEN === '4') {
      this.estado = 'Factura PENDIENTE DE PAGO.'; 
    } else if (this.fact.EDO_CUEN === '6' || this.fact.EDO_CUEN === '8') {
      this.estado = 'Factura PAGADA.'; 
    } else if (this.fact.EDO_CUEN === '7') {
      this.estado = 'Factura CANCELADA.'; 
    }

    this.factura = [{    
        eminam: 'AGENCIA DE COMERCIO EXTERIOR S.A.',
        emirfc: 'AAQ123456D34',
        emireg: '601 -GENERAL DE LEY PERSONAS MORALES',
        recnam: 'CLIENTE CONSTANTE S.A.',
        recrfc: 'DSA892314R78',
        reccop: '02810',
        recuso: 'G03 -GASTOS EN GENERAL',
      
        fecemi: '15/11/2018 11:40:44',
        certif: '15/11/2018 11:40:48',
        lugexp: '05536',
        tipcom: 'I -Ingreso',
        forpag: '99 -POR DEFINIR',
        metpag: 'PPD -PAGO EN PARCIALIDADES O DIFERIDO',
        folfis: '12BA786C-376F-47B8-ADD3-88E8C8C043D0',

        numref: 'REF18000001',
        numped: 'A1 470 9999 00000001',
        tipcam: 20.13290,
        guimas: '1123-9340865',
        guihou: 'AXAS11239340',
        pesbru: 2232,
        numbul: 6,
        desmer: 'LA MERCANCIA QUE SE MANEJA',
        conpag: '',
        pronam: 'PROVEDOR INTERNACIONAL C.V.',
        numfac: 'IN20180234',
        valadu: 690812.34,
        numcon: 'AFA23341',

        subtot: 6407.46,
        valiva: 1025.19,
        valtot: 7432.65,
        lettot: 'SIETE MIL CUA TROCIENTOS TREINTA Y DOS PESOS 65/100 M.N.',

        ceptos: [
          {CLAVE: '78141502', CANT: 1, UNIDAD: 'E48 -SERVICIO', DESCRIP: 'SELLOS', UNITA: 70, IMPO: 70},
          {CLAVE: '80151605', CANT: 1, UNIDAD: 'E48 -SERVICIO', DESCRIP: 'SERVICIOS COMPLEMENTARIOS', UNITA: 2125, IMPO: 2125},
          {CLAVE: '80151605', CANT: 1, UNIDAD: 'E48 -SERVICIO', DESCRIP: 'HONORARIOS AL 0.450% SOBRE : $ 936,101.20', UNITA: 4212.46, IMPO: 4212.46}
        ],

        gastos: [
          {CONCEPTO: 'MANIOBRAS', FACTURA: '21662328', IMPDIR: 0, IMPAA: 7845.20},
          {CONCEPTO: 'IMPUESTOS', FACTURA: '1233-1743', IMPDIR: 0, IMPAA: 237444.00}
        ],

        totgts: 245289.20,
        totfac: 7432.65,
        totall: 252721.85,
        totant: 250000,
        totsal: 2721.85,
        letsal: 'DOS MIL SETECIENTOS VEINTIUN PESOS 85/100 M.N.',
        observ: ''
      }];
    // console.log(this.factura);   
    
  }

  ngOnInit() {
  }

  

}
